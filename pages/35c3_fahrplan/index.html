<html>

<head>
    <meta charset="UTF-8">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/3.0.1/mustache.min.js"></script>
    <script src="sugar2.0.4.js"></script>
    <!--style>
        body {
            margin: 0;
            padding: 0;
            font-size: 25px;
            color: greenyellow;
            background-color: #1e2721;
            font-family: 'Courier New', Courier, monospace;
        }

        #title {
            font-size: 2em;
            font-weight: bold;
            width: 100%;
            padding-left: 40px;
            padding-right: 40px;
            padding-top: 20px;
            padding-bottom: 10px;
						color: #19abff;
        }

        .news {
            width: 100%;
            padding-left: 40px;
            padding-right: 40px;
            animation: flicker 0.15s infinite;
        }

        .news_node {
            width: 100%;
        }

        .news_title {
            font-size: 1em;
            padding-bottom: 10px;
            padding-left: 80px;
            padding-right: 40px;
            font-weight: bold;
						color: #f440ff;
        }

        .news_author {
            font-size: 1em;
            padding-left: 80px;
            padding-right: 40px;
						color: #ff8a00;
        }

        .news_room {
            font-size: 1em;
            padding-left: 80px;
            padding-right: 40px;
						color: #ff8a00;
        }

        .news_content {
            font-size: 1em;
            padding-bottom: 20px;
            padding-left: 80px;
            padding-right: 40px;
        }

        .news_lineno {
            float: left;
            text-align: right;
            width: 80px;
						color: #19abff;
        }
        .news_lineno_slash {
						color: #ff8a00;
        }

        .clear {
            clear: both;
        }

    </style-->
    <!--script  id="news_template" type="x-tmpl-mustache">
    {{#items}}
    <div class="news_node">
      <div class="clear"></div>
      <div class="news_title">{{title}}</div>
      <div class="clear"></div>
      <div class="news_author">{{author}}</div>
      <div class="clear"></div>
      <div class="news_content">{{description}}</div>
    </div>
    {{/items}}
  </script-->

  <script  id="news_template" type="x-tmpl-mustache">
  {{#items}}
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">{{title}}</h5>
        <h6 class="card-subtitle mb-2 text-muted">{{author}}</h6>
        <p class="card-text">{{description}}</p>
        <a href="#" class="btn btn-primary">{{track}}</a>
      </div>
    </div>
    {{/items}}
    </script>
</head>

<body>

    <div class="card-columns" id="news">

    </div>

    <script>
    Number.prototype.pad = function(size) {
    var s = String(this);
    while (s.length < (size || 2)) {s = "0" + s;}
    return s;
    }

    items = []

    $( document ).ready(function() {
      i = 0
      $.getJSON("https://feeds.noppelmax.online/schedule.json", function (data) {
        console.log(data);
        $.each(data.schedule.conference.days, function(day){
          console.log(day)
          $.each(data.schedule.conference.days[day].rooms, function(room){
            console.log(room);
            $.each(data.schedule.conference.days[day].rooms[room], function(idx){
              itm = data.schedule.conference.days[day].rooms[room][idx]
              authors = ""
              $.each(itm.persons,function(p){
                if(authors != ""){
                  authors += ", ";
                }
                authors = authors + itm.persons[p].public_name;
              })

              d = new Date(itm.date);
              console.log(d.getFullYear());

              item = {
                  title: itm.title,
                  link: "link",
                  description: room + ", " + d.getDate() + "." + (d.getMonth()+1) + ", " + d.getHours().pad(2) + ":" + d.getMinutes().pad(2),
                  room: room,
                  author: authors,
                  date: d,
                  track: itm.track,
                  type: itm.type
              };

              items.push(item);
            });
          });
          items.sort(function(a,b){
            return new Date(a.date) - new Date(b.date);
          })

          //items = items.filter(function(el) { return el.date > Date.now(); });
          items = items.filter(function(el) { return el.date > new Date("2018-12-29T15:00:00+01:00"); });

          var template = $('#news_template').html();
          Mustache.parse(template);   // optional, speeds up future uses
          var rendered = Mustache.render(template, {"items": items});
          $('#news').html(rendered);
        });
      });
    });




    </script>
		<script>
    /*
			speed = 30
			function pageScroll() {
    		window.scrollBy(0,1);
    		scrolldelay = setTimeout(pageScroll,speed);
			}
			setTimeout(pageScroll,4000);
      */
		</script>

</body>

</html>
